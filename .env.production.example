# gLabels Batch Service - Production Configuration Template
# Copy this file to .env.production and adjust values as needed
# 
# WARNING: DO NOT commit .env.production with real values to git!
# Prefer using system environment variables in production instead of .env files.

# ======================
# Environment mode
# ======================
# CRITICAL: Must be set to production
ENVIRONMENT=production

# ======================
# Server settings
# ======================
HOST=0.0.0.0
PORT=8000

# CRITICAL: MUST be false in production!
# Setting RELOAD=true will cause the application to fail startup validation
RELOAD=false

# ======================
# Application settings
# ======================

# Production: false (saves disk space and improves security)
KEEP_CSV=false

# Maximum number of parallel jobs
# 0 = auto (reads cgroup CPU limit inside containers, falls back to host CPU count)
# >0 = explicit number of workers
# Auto-detection is safe for both Docker and bare-metal deployments.
# Override only if you need a specific worker count different from (detected CPUs - 1).
MAX_PARALLEL=0

# Maximum labels per batch before auto-split and PDF merge
# Production recommendation: 500-800 for x86 servers, 200-300 for ARM/embedded
MAX_LABELS_PER_BATCH=300

# Maximum labels per job request
MAX_LABELS_PER_JOB=2000

# Timeout per job in seconds (default 600 = 10 minutes)
# Production: Adjust based on typical job size
GLABELS_TIMEOUT=600

# Hours to retain job state in memory before cleanup
# Production: Lower value saves memory (e.g., 12-24 hours)
RETENTION_HOURS=24

# Maximum request body size in bytes (default 5MB)
MAX_REQUEST_BYTES=5000000

# Maximum number of fields per label record
MAX_FIELDS_PER_LABEL=50

# Maximum length per field value
MAX_FIELD_LENGTH=2048

# ======================
# Logging settings
# ======================

# Production: WARNING or ERROR (reduces log volume)
# Use INFO for initial deployment, then raise to WARNING/ERROR
LOG_LEVEL=WARNING

# Log format: text | json
# json is best for log aggregation systems (Loki/ELK)
LOG_FORMAT=text

# Directory for log files (relative or absolute). Default: logs
LOG_DIR=logs

# ======================
# Safety & observability
# ======================

# Request ID header name
REQUEST_ID_HEADER=X-Request-ID

# Rate limit for /labels/print (example: 60/minute)
RATE_LIMIT=60/minute

# Enable Prometheus metrics endpoint (/metrics)
ENABLE_METRICS=true

# Graceful shutdown timeout (seconds)
SHUTDOWN_TIMEOUT=30

# ======================
# CORS settings
# ======================

# Comma-separated list of allowed origins
# Production: Specify exact origins (never use *)
# Example: CORS_ALLOW_ORIGINS=https://your-frontend.com,https://app.example.com
CORS_ALLOW_ORIGINS=
